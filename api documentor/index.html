<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Qunb API documentation</title>
	<meta name="author" content="Qunb team">

	<meta name="viewport" content="width=device-width">

	<link rel="stylesheet" href="css/style.css">
	<link href="css/theme.css" rel="stylesheet" type="text/css">
</head>
<body>
<header>
	<h1> Qunb Rest API </h1>
</header>
<div class="main">

	<div class="section">
		<!-- This zone is AUTOMATICALLY populated-->
		<div class="title">Summary</div>
		<div class="summary-container"></div>
		<div class="clearfix"></div>
	</div>


</div>
<footer>
</footer>

<script src="js/libs/jquery-1.7.1.min.js"></script>
<script src="js/libs/rainbow-custom.min.js"></script>
<script src="js/libs/underscore.js"></script>
<script src="js/api-documentor.js"></script>


<!--                    -->
<!--   TEMPLATES        -->
<!--                    -->

<!--  SECTION VIEW      -->
<script type="text/template" id="section-template">

  <!-- API SECTION -->
  <div class="section" id="<%=encodeURI(section.title.replace(' ','_'))%>">
    
    <!-- Section title -->
    <div class="title"><%=section.title%></div>

    <% _.each(section.actions, function(action){ %>
        <%= templates && templates.action_template && templates.action_template({ action: action, templates: templates }) %>
    <% }); %>

  </div>
  <!-- / API SECTION -->
</script>

<!--  ACTION VIEW       -->
<script type="text/template" id="action-template">

  <!-- API ACTION START -->
    <div class="action" id="<%=encodeURI(action.title.replace(' ','_'))%>">

      <!-- Left Part: action description -->
      <div class="description">

        <!-- Action title -->
        <div class="title"><%=action.title%></div>
        <div class="more-info">
          <%=action.description%>
        </div>

        <% if(action.params && action.params.length > 0) { %>
          <!-- Action parameters -->
          <div class="subtitle">Parameters</div>
          <ul class="parameters">
            <% _.each(action.params, function(param){ %>
              <li><span class="name"><%=param.id%></span><% if(param.description) { %><span class="description"><% if(param.optionnal){ print('(opt) '); } %><%=param.description%></span></li><% } %>
            <% }); %>
          </ul>
        <% } %>

        <% if(action.errors && action.errors.length > 0) { %>
          <!-- Action errors -->
          <div class="subtitle">Errors</div>
          <ul class="parameters">
            <% _.each(action.errors, function(error){ %>
              <li><span class="name"><%=error.code%></span><% if(error.description) { %><span class="description"><%=error.description%></span></li><% } %>
            <% }); %>
          </ul>
        <% } %>

      </div>

      <!-- Right part: action request -->
      <div class="request">

        <!-- Request end point -->
        <div class="title"><%=action.method%> <%=action.uri%></div>

        <!-- Request examples -->
        <% if(action.examples && action.examples.length > 0) { %>
          <% _.each(action.examples, function(example){ %>

            <%= templates && templates.example_template && templates.example_template({ example: example }) %>
          
          <% }); %>
        <% } %>

      </div>
      <div class="clearfix"></div>
    </div>
    <!-- API ACTION END-->
</script>

<!--  EXAMPLE VIEW      -->
<script type="text/template" id="example-template">
  
  <div class="subtitle"><%=example.title%>:</div>

  <!-- Request example -->
  <div class="example-request"><%=example.method%> <%=example.uri%>
  <% if(example.headers && example.headers.length>0) { %>
    <% _.each(example.headers, function(header){ %>
      <br><%=header.key%>: <%=header.value%>
    <% }); %>
  <% } %>
  </div>

  <% if(example.payload){%>
    <div class="subtitle">Payload:</div>
    <div class="example-response unloaded">
      <pre><code data-fixture=<%=example.payload%>><%=example.payload%></code></pre>  
    </div>
  <% } %>

  <% if(example.response){%>
    <div class="subtitle">Response:</div>
    <div class="example-response unloaded">
      <pre><code data-fixture=<%=example.response%>><%=example.response%></code></pre>  
    </div>
  <% } %>
  
  <br>
</script>




<script>

// Open / close the json example
$(".main").on("click",".example-response.loaded",function(){
	$(this).toggleClass("open");
});

// Load the json fixture
$(".main").on("click",".example-response.unloaded",function(){

  $this = $(this);

  this.code_el = $this.find('code');
  
  // get the fixture uri for the data-fixture attribute in the <code> element
  var fixture_uri = this.code_el.data('fixture');
  
  if(fixture_uri){

    // fetch the fixture uri
    $.ajax({
      url: fixture_uri,
      dataType: "html", // we do not want the JSON to be parsed before display
      context: this, // set the context for the async callbacks
      success: function(value){

        // insert a highlighted version of the json
        Rainbow.color(value, 'javascript', (function(_this){ return function(highlighted_code){
          _this.code_el.html(highlighted_code);
        }; })(this));

        // remember that this fixture has been loaded
        $this.removeClass('unloaded');
        $this.addClass('loaded');
      },
      error: function(){
        window.alert("Can't load "+fixture_uri);
      }
    });

  }

});

$(document).ready(function() {

    var AD = new ApiDocumentor({
      section_template: $('#section-template').html(),
      action_template: $('#action-template').html(),
      example_template: $('#example-template').html(),
      target: $(".main"),
      generateSummary: true,
      summaryTarget: $('.summary-container')
    });

    AD.fetch('scheme.json');
    
});
</script>

</body>
</html>
